                                                                                 # ğƒğšğ­ğš ğ›ğ«ğ¢ğœğ¤ğ¬ ğˆğ§ğ­ğğ«ğ¯ğ¢ğğ° ğğ®ğğ¬ğ­ğ¢ğ¨ğ§ğ¬
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ: ğ‚ğ®ğ¦ğ®ğ¥ğšğ­ğ¢ğ¯ğ ğ‘ğğ¯ğğ§ğ®ğ ğ©ğğ« ğƒğšğ²

ğ‚ğ¨ğ§ğœğğ©ğ­: ğ“ğ¡ğ¢ğ¬ ğªğ®ğğ¬ğ­ğ¢ğ¨ğ§ ğ­ğğ¬ğ­ğ¬ ğ²ğ¨ğ®ğ« ğšğ›ğ¢ğ¥ğ¢ğ­ğ² ğ­ğ¨ ğ®ğ¬ğ ğ°ğ¢ğ§ğğ¨ğ° ğŸğ®ğ§ğœğ­ğ¢ğ¨ğ§ğ¬, 
ğ¬ğ©ğğœğ¢ğŸğ¢ğœğšğ¥ğ¥ğ² ğ’ğ”ğŒ() ğğ•ğ„ğ‘(), ğ­ğ¨ ğœğšğ¥ğœğ®ğ¥ğšğ­ğ ğ«ğ®ğ§ğ§ğ¢ğ§ğ  ğ­ğ¨ğ­ğšğ¥ğ¬.
*/

CREATE DATABASE Data_Bricks;

USE Data_Bricks;

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Sales (
    sale_date DATE,
    revenue INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Sales (sale_date, revenue) VALUES
('2025-01-01', 100),
('2025-01-01', 50),
('2025-01-02', 75),
('2025-01-03', 120),
('2025-01-03', 30),
('2025-01-04', 90);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+------------+-------------------+------------------------+
| sale_date  | daily_total_revenue | cumulative_total_revenue |
+------------+-------------------+------------------------+
| 2025-01-01 | 150               | 150                    |
| 2025-01-02 | 75                | 225                    |
| 2025-01-03 | 150               | 375                    |
| 2025-01-04 | 90                | 465                    |
+------------+-------------------+------------------------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/* ğğŸ) ğğ®ğğ¬ğ­ğ¢ğ¨ğ§ ğŸ: ğ…ğ¢ğ«ğ¬ğ­ ğšğ§ğ ğ‹ğšğ¬ğ­ ğ‹ğ¨ğ ğ¢ğ§ ğğğ« ğ”ğ¬ğğ«
ğ‚ğ¨ğ§ğœğğ©ğ­: ğ“ğ¡ğ¢ğ¬ ğ­ğğ¬ğ­ğ¬ ğ²ğ¨ğ®ğ« ğšğ›ğ¢ğ¥ğ¢ğ­ğ² ğ­ğ¨ ğŸğ¢ğ§ğ ğ¦ğ¢ğ§ğ¢ğ¦ğ®ğ¦ ğšğ§ğ ğ¦ğšğ±ğ¢ğ¦ğ®ğ¦ ğ¯ğšğ¥ğ®ğğ¬ 
ğ ğ«ğ¨ğ®ğ©ğğ ğ›ğ² ğšğ§ ğ¢ğğğ§ğ­ğ¢ğŸğ¢ğğ«, ğ¨ğŸğ­ğğ§ ğ®ğ¬ğ¢ğ§ğ  ğ†ğ‘ğğ”ğ ğğ˜ ğ°ğ¢ğ­ğ¡ ğšğ ğ ğ«ğğ ğšğ­ğ ğŸğ®ğ§ğœğ­ğ¢ğ¨ğ§ğ¬, ğ¨ğ« ğ¬ğ¨ğ¦ğğ­ğ¢ğ¦ğğ¬
ğ°ğ¢ğ§ğğ¨ğ° ğŸğ®ğ§ğœğ­ğ¢ğ¨ğ§ğ¬ ğŸğ¨ğ« ğ¦ğ¨ğ«ğ ğœğ¨ğ¦ğ©ğ¥ğğ± ğ¬ğœğğ§ğšğ«ğ¢ğ¨ğ¬
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE  UserLogins (
    user_id INT NOT NULL,
    login_timestamp DATETIME2 NOT NULL
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO  UserLogins (user_id, login_timestamp) VALUES
(101, '2025-03-01 08:00:00'),
(102, '2025-03-01 09:15:00'),
(101, '2025-03-01 10:30:00'),
(103, '2025-03-02 11:00:00'),
(102, '2025-03-02 14:45:00'),
(101, '2025-03-03 07:00:00'),
(103, '2025-03-03 16:30:00');

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+---------+---------------------+---------------------+
| user_id | first_login         | last_login          |
+---------+---------------------+---------------------+
| 101     | 2025-03-01 08:00:00 | 2025-03-03 07:00:00 |
| 102     | 2025-03-01 09:15:00 | 2025-03-02 14:45:00 |
| 103     | 2025-03-02 11:00:00 | 2025-03-03 16:30:00 |
+---------+---------------------+---------------------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/* ğğŸ‘) ğğ®ğğ¬ğ­ğ¢ğ¨ğ§ ğŸ‘: ğ“ğ¨ğ© ğŸ‘ ğ‚ğ®ğ¬ğ­ğ¨ğ¦ğğ«ğ¬ ğ›ğ² ğ’ğ©ğğ§ğ ğ¢ğ§ ğ„ğšğœğ¡ ğ‘ğğ ğ¢ğ¨ğ§
ğ‚ğ¨ğ§ğœğğ©ğ­: ğ“ğ¡ğ¢ğ¬ ğ¢ğ¬ ğš ğœğ¥ğšğ¬ğ¬ğ¢ğœ "ğ­ğ¨ğ© ğ ğ©ğğ« ğ ğ«ğ¨ğ®ğ©" ğ©ğ«ğ¨ğ›ğ¥ğğ¦, ğ›ğğ¬ğ­ ğ¬ğ¨ğ¥ğ¯ğğ
ğ®ğ¬ğ¢ğ§ğ  ğ°ğ¢ğ§ğğ¨ğ° ğŸğ®ğ§ğœğ­ğ¢ğ¨ğ§ğ¬, ğ¬ğ©ğğœğ¢ğŸğ¢ğœğšğ¥ğ¥ğ² ğ‘ğğ–_ğğ”ğŒğğ„ğ‘(), ğ‘ğ€ğğŠ(), ğ¨ğ« ğƒğ„ğğ’ğ„_ğ‘ğ€ğğŠ() 
ğ°ğ¢ğ­ğ¡ ğğ€ğ‘ğ“ğˆğ“ğˆğğ ğğ˜.
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    region VARCHAR(50),
    spend INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Orders (order_id, customer_id, region, spend) VALUES
(1, 101, 'North', 150),(2, 102, 'South', 200),
(3, 103, 'North', 100),(4, 101, 'North', 50),
(5, 104, 'West', 300),(6, 102, 'South', 75),
(7, 105, 'North', 250),(8, 106, 'West', 180),
(9, 107, 'South', 120),(10, 103, 'North', 80),
(11, 108, 'East', 400),(12, 109, 'East', 150),
(13, 110, 'East', 220),
(14, 111, 'East', 90);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+-------------+--------+-------------+
| customer_id | region | total_spend |
+-------------+--------+-------------+
| 105         | North  | 250         |
| 101         | North  | 200         |
| 103         | North  | 180         |
| 102         | South  | 275         |
| 107         | South  | 120         |
| 104         | West   | 300         |
| 106         | West   | 180         |
| 108         | East   | 400         |
| 110         | East   | 220         |
| 109         | East   | 150         |
+-------------+--------+-------------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ’)ğƒğğ­ğğœğ­ ğšğ§ğ ğƒğğ¥ğğ­ğ ğƒğ®ğ©ğ¥ğ¢ğœğšğ­ğ ğ“ğ«ğšğ§ğ¬ğšğœğ­ğ¢ğ¨ğ§ğ¬
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Transactions_ (
    transaction_id VARCHAR(10),
    transaction_date DATE,
    user_id INT,
    amount INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Transactions_ (transaction_id, transaction_date, user_id, amount) VALUES
('T001', '2025-05-01', 101, 100),
('T002', '2025-05-01', 102, 150),
('T001', '2025-05-01', 101, 100),  
('T003', '2025-05-02', 103, 200),
('T002', '2025-05-01', 102, 150),  
('T004', '2025-05-02', 101, 50),

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+----------------+----------------+---------+--------+
| transaction_id | transaction_date | user_id | amount |
+----------------+----------------+---------+--------+
| T001           | 2025-05-01     | 101     | 100    |
| T002           | 2025-05-01     | 102     | 150    |
| T003           | 2025-05-02     | 103     | 200    |
| T004           | 2025-05-02     | 101     | 50     |
+----------------+----------------+---------+--------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ“:ğ”ğ¬ğğ«ğ¬ ğ°ğ¢ğ­ğ¡ ğğ®ğ«ğœğ¡ğšğ¬ğğ¬ ğ¢ğ§ ğŸ‘ ğ‚ğ¨ğ§ğ¬ğğœğ®ğ­ğ¢ğ¯ğ ğŒğ¨ğ§ğ­ğ¡ğ¬
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Purchases (
    purchase_id VARCHAR(10) PRIMARY KEY,
    user_id INT,
    purchase_date DATE,
    amount INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Purchases (purchase_id, user_id, purchase_date, amount) VALUES
('P001', 101, '2025-01-15', 25),('P002', 102, '2025-01-20', 30),
('P003', 101, '2025-02-10', 40),('P004', 103, '2025-02-25', 50),
('P005', 101, '2025-03-05', 60),('P006', 102, '2025-03-18', 35),
('P007', 104, '2025-03-22', 100),('P008', 101, '2025-04-01', 70),
('P009', 103, '2025-04-10', 55),('P010', 102, '2025-05-01', 45),
('P011', 101, '2025-06-01', 80);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+---------+
| user_id |
+---------+
|   101   |
+---------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ”:ğŸ•-ğƒğšğ² ğŒğ¨ğ¯ğ¢ğ§ğ  ğ€ğ¯ğğ«ğšğ ğ ğ¨ğŸ ğğ«ğ¨ğğ®ğœğ­ ğ’ğšğ¥ğğ¬
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Purchases_ (
    purchase_id VARCHAR(10),
    customer_id INT,
    purchase_date DATE,
    amount INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Purchases_ (purchase_id, customer_id, purchase_date, amount)
VALUES 
('P001', 101, '2024-01-05', 25),('P002', 102, '2024-01-10', 30),
('P003', 101, '2024-02-15', 40),('P004', 103, '2024-02-20', 50),
('P005', 101, '2024-03-01', 60),('P006', 102, '2024-03-18', 35),
('P007', 101, '2024-04-05', 70),('P008', 103, '2024-04-10', 55),
('P009', 101, '2024-05-01', 80),('P010', 102, '2024-05-10', 45),
('P011', 101, '2024-06-01', 90),('P012', 103, '2024-06-15', 65),
('P013', 101, '2024-07-01', 100),('P014', 102, '2024-07-20', 50),
('P015', 101, '2024-08-01', 110),('P016', 103, '2024-08-05', 75),
('P017', 101, '2024-09-01', 120),('P018', 102, '2024-09-10', 60),
('P019', 101, '2024-10-01', 130),('P020', 103, '2024-10-20', 80),
('P021', 101, '2024-11-01', 140),('P022', 102, '2024-11-15', 65),
('P023', 101, '2024-12-01', 150),
('P024', 103, '2024-12-10', 90);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+--------------+-------------+--------------+---------------------+
| purchase_date| customer_id | total_amount | seven_day_moving_avg|
+--------------+-------------+--------------+---------------------+
| 2024-01-05   |     101     |      25      |        25.0         |
| 2024-02-15   |     101     |      40      |        32.5         |
| 2024-03-01   |     101     |      60      |        41.67        |
| 2024-04-05   |     101     |      70      |        48.75        |
| 2024-05-01   |     101     |      80      |        55.0         |
| 2024-06-01   |     101     |      90      |        60.83        |
| 2024-07-01   |     101     |     100      |        66.43        |
| 2024-08-01   |     101     |     110      |        78.57        |
| 2024-09-01   |     101     |     120      |        90.0         |
| 2024-10-01   |     101     |     130      |       104.29        |
| 2024-11-01   |     101     |     140      |       110.0         |
| 2024-12-01   |     101     |     150      |       117.14        |
+--------------+-------------+--------------+---------------------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ•: ğ‚ğ®ğ¬ğ­ğ¨ğ¦ğğ«ğ¬ ğ–ğ¡ğ¨ ğğ¨ğ®ğ ğ¡ğ­ ğğ«ğ¨ğğ®ğœğ­ğ¬ ğ„ğ¯ğğ«ğ² ğŒğ¨ğ§ğ­ğ¡ ğ¢ğ§ ğš ğ˜ğğšğ« 
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Purchases_ (
    purchase_id VARCHAR(10),
    customer_id INT,
    purchase_date DATE,
    amount INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Purchases_ (purchase_id, customer_id, purchase_date, amount)
VALUES 
('P001', 101, '2024-01-05', 25),('P002', 102, '2024-01-10', 30),
('P003', 101, '2024-02-15', 40),('P004', 103, '2024-02-20', 50),
('P005', 101, '2024-03-01', 60),('P006', 102, '2024-03-18', 35),
('P007', 101, '2024-04-05', 70),('P008', 103, '2024-04-10', 55),
('P009', 101, '2024-05-01', 80),('P010', 102, '2024-05-10', 45),
('P011', 101, '2024-06-01', 90),('P012', 103, '2024-06-15', 65),
('P013', 101, '2024-07-01', 100),('P014', 102, '2024-07-20', 50),
('P015', 101, '2024-08-01', 110),('P016', 103, '2024-08-05', 75),
('P017', 101, '2024-09-01', 120),('P018', 102, '2024-09-10', 60),
('P019', 101, '2024-10-01', 130),('P020', 103, '2024-10-20', 80),
('P021', 101, '2024-11-01', 140),('P022', 102, '2024-11-15', 65),
('P023', 101, '2024-12-01', 150),
('P024', 103, '2024-12-10', 90);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+-------------+------+
| customer_id |  yr  |
+-------------+------+
|     101     | 2024 |
+-------------+------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ–:ğ‘ğšğ§ğ¤ ğğ«ğ¨ğğ®ğœğ­ğ¬ ğ›ğ² ğ’ğšğ¥ğğ¬ ğğğ« ğ˜ğğšğ«
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Sales_data (
    sale_date DATE,
    product_id VARCHAR(10),
    sales_amount INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Sales_data (sale_date, product_id, sales_amount)
VALUES
('2024-01-01', 'P001', 100),
('2024-01-05', 'P002', 150),
('2024-02-10', 'P001', 200),
('2024-03-01', 'P003', 120),
('2024-04-15', 'P002', 180),
('2024-05-20', 'P001', 250),
('2024-06-01', 'P003', 90),
('2025-01-01', 'P001', 300),
('2025-01-10', 'P002', 220),
('2025-02-15', 'P003', 180),
('2025-03-01', 'P001', 350),
('2025-04-05', 'P002', 280),
('2025-05-10', 'P003', 200);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+------+------------+--------------+-----+
| Year | product_id | total_amount | rnk |
+------+------------+--------------+-----+
| 2024 | P001       |     550      |  1  |
| 2024 | P002       |     330      |  2  |
| 2024 | P003       |     210      |  3  |
| 2025 | P001       |     650      |  1  |
| 2025 | P002       |     500      |  2  |
| 2025 | P003       |     380      |  3  |
+------+------------+--------------+-----+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸ—:ğ„ğ¦ğ©ğ¥ğ¨ğ²ğğğ¬ ğ„ğšğ«ğ§ğ¢ğ§ğ  ğŒğ¨ğ«ğ ğ“ğ¡ğšğ§ ğƒğğ©ğšğ«ğ­ğ¦ğğ§ğ­ ğ€ğ¯ğğ«ğšğ ğ
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Employees (
    employee_id INT,
    employee_name VARCHAR(50),
    department VARCHAR(50),
    salary INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Employees (employee_id, employee_name, department, salary)
VALUES
(101, 'Alice', 'Sales', 60000),
(102, 'Bob', 'Sales', 75000),
(103, 'Charlie', 'Sales', 50000),
(104, 'David', 'Marketing', 80000),
(105, 'Eve', 'Marketing', 70000),
(106, 'Frank', 'Marketing', 90000),
(107, 'Grace', 'HR', 65000),
(108, 'Heidi', 'HR', 60000);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+-------------+----------------+-------------+--------+
| employee_id | employee_name  | department  | salary |
+-------------+----------------+-------------+--------+
| 102         | Bob            | Sales       | 75000  |
| 106         | Frank          | Marketing   | 90000  |
| 107         | Grace          | HR          | 65000  |
+-------------+----------------+-------------+--------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
## ğŸ“Œ ğğ«ğ¨ğ›ğ¥ğğ¦ ğ’ğ­ğšğ­ğğ¦ğğ§ğ­

/*
ğğŸğŸ:ğ‚ğ®ğ¬ğ­ğ¨ğ¦ğğ«ğ¬ ğ–ğ¡ğ¨ğ¬ğ ğ…ğ¢ğ«ğ¬ğ­ ğšğ§ğ ğ‹ğšğ¬ğ­ ğ“ğ«ğšğ§ğ¬ğšğœğ­ğ¢ğ¨ğ§ ğ¨ğ§ ğ’ğšğ¦ğ ğƒğšğ²
*/

## ğ“ğšğ›ğ¥ğ
CREATE TABLE Transactions__ (
    transaction_id VARCHAR(10),
    customer_id INT,
    transaction_date DATE,
    amount INT
);

## ğ’ğšğ¦ğ©ğ¥ğ ğƒğšğ­ğš
INSERT INTO Transactions__ (transaction_id, customer_id, transaction_date, amount) VALUES
('T001', 101, '2025-04-01', 100),
('T002', 102, '2025-04-05', 150),
('T003', 101, '2025-04-01', 50),   -- Same day as T001
('T004', 103, '2025-04-10', 200),
('T005', 102, '2025-04-05', 75),   -- Same day as T002
('T006', 104, '2025-04-12', 300),
('T007', 103, '2025-04-11', 90),
('T008', 105, '2025-04-15', 180);

## âœ… ğ„ğ±ğ©ğğœğ­ğğ ğğ®ğ­ğ©ğ®ğ­
+-------------+---------------------+--------------------+
| customer_id | first_transaction_date | last_transaction_date |
+-------------+---------------------+--------------------+
|    101      | 2025-04-01          | 2025-04-01         |
|    102      | 2025-04-05          | 2025-04-05         |
|    104      | 2025-04-12          | 2025-04-12         |
|    105      | 2025-04-15          | 2025-04-15         |
+-------------+---------------------+--------------------+

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------














